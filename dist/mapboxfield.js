!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function a(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}var o=function(){function e(a){t(this,e),this.mapboxgl=mapboxgl,this.mapboxgl.accessToken=a.accesstoken,this.accesstoken=a.accesstoken,this.styleurl=a.styleurl,this.lng=a.lng,this.lat=a.lat,this.pitch=a.pitch,this.bearing=a.bearing,this.zoom=a.zoom,this.comment=a.comment,this.mapsize=a.mapsize,this.maptype=a.maptype,this.formlngtag=a.formlngtag,this.formlattag=a.formlattag,this.formzoomtag=a.formzoomtag,this.formpitchtag=a.formpitchtag,this.formbearingtag=a.formbearingtag,this.formsizetag=a.formsizetag,this.formcommenttag=a.formcommenttag,this.formsetstyleurltag=a.formsetstyleurltag,this.maptag=a.maptag,this.mapwrappertag=a.maptagwrapper,this.geocodertag=a.geocodertag,this.accesstoken_styleurltag=a.accesstoken_styleurltag}return a(e,[{key:"instanceMethod",value:function(){this.instantiationMap(),this.instantiationMarker(),this.instantiationPopup(),this.addExtentionToMap(this.map)}},{key:"instantiationMap",value:function(){this.map=new this.mapboxgl.Map({container:"map",style:this.styleurl,center:[this.lng,this.lat],zoom:this.zoom,pitch:this.pitch,bearing:this.bearing})}},{key:"instantiationMarker",value:function(){this.marker=new this.mapboxgl.Marker({draggable:!0}).setLngLat(this.map.getCenter()).addTo(this.map)}},{key:"instantiationPopup",value:function(){this.popup=(new mapboxgl.Popup).setHTML(this.comment),this.marker.setPopup(this.popup)}},{key:"addExtentionToMap",value:function(t){t.addControl(new mapboxgl.NavigationControl,"top-left"),t.addControl(new mapboxgl.FullscreenControl),t.addControl(new mapboxgl.ScaleControl({maxWidth:80,unit:"metric"}))}},{key:"setDefaultValueToForm",value:function(){this.formlngtag.value=this.lng,this.formlattag.value=this.lat,this.formzoomtag.value=this.zoom,this.formpitchtag.value=this.pitch,this.formbearingtag.value=this.bearing}},{key:"setMapPitchToForm",value:function(t){var e=this;t.on("pitch",(function(t){e.formpitchtag.value=t.target.getPitch()}))}},{key:"setMapBearingToForm",value:function(t){var e=this;t.on("rotate",(function(t){e.formbearingtag.value=t.target.getBearing()}))}},{key:"setMapZoomToForm",value:function(t){var e=this;t.on("zoom",(function(){e.formzoomtag.value=t.getZoom()}))}},{key:"getMarkerDropLocation",value:function(t){var e=this;this.marker.on("dragend",(function(){var a=e.marker.getLngLat();e.formlngtag.value=a.lng,e.formlattag.value=a.lat,t.flyTo({center:[a.lng,a.lat]})}))}},{key:"changePopupComment",value:function(){var t=document.getElementById("comment");this.popup.setHTML(t.value)}},{key:"adaptFormCommentToPopup",value:function(){this.formcommenttag.addEventListener("change",{popup:this.popup,handleEvent:this.changePopupComment})}},{key:"adaptFormLocationToMarker",value:function(){var t=this;this.formlngtag.addEventListener("change",(function(){t.map.flyTo({center:[t.formlngtag.value,t.formlattag.value]}),t.marker.setLngLat([t.formlngtag.value,t.formlattag.value]).addTo(t.map)})),this.formlattag.addEventListener("change",(function(){t.map.flyTo({center:[t.formlngtag.value,t.formlattag.value]}),t.marker.setLngLat([t.formlngtag.value,t.formlattag.value]).addTo(t.map)}))}}]),e}(),n=function(){function e(a){t(this,e),this.map=a.map,this.marker=a.marker,this.mapboxgl=a.mapboxgl,this.accesstoken=a.accesstoken,this.formlngtag=a.formlngtag,this.formlattag=a.formlattag,this.geocodertag=a.geocodertag,this.instantiationGeooder(),this.setStyleGeocoderTag(),this.setStyleInput(),this.setLngLatToForm(),this.setMarkerToLngLat()}return a(e,[{key:"instantiationGeooder",value:function(t){this.geocoder=new MapboxGeocoder({accessToken:this.accesstoken,mapboxgl:this.mapboxgl,marker:!1,placeholder:"検索"}),this.geocodertag.appendChild(this.geocoder.onAdd(this.map))}},{key:"setStyleGeocoderTag",value:function(){this.geocodertag.style.Width="100%",this.geocodertag.style.marginTop="5px"}},{key:"setStyleInput",value:function(){this.geocodertag.getElementsByClassName("mapboxgl-ctrl-geocoder")[0].style.minWidth="100%";var t=this.geocodertag.getElementsByClassName("mapboxgl-ctrl-geocoder--input")[0];t.style.paddingLeft="35px",t.style.width="100%"}},{key:"setLngLatToForm",value:function(){var t=this;this.geocoder.on("result",(function(e){var a=e.result.center;t.formlngtag.value=a[0],t.formlattag.value=a[1]}))}},{key:"setMarkerToLngLat",value:function(){var t=this;this.geocoder.on("result",(function(e){var a=e.result.center;t.marker.setLngLat([a[0],a[1]]).addTo(t.map)}))}}]),e}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e,a){return e&&s(t.prototype,e),a&&s(t,a),t}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,o,n,r=g(t);if(e){var s=g(this).constructor;a=Reflect.construct(r,arguments,s)}else a=r.apply(this,arguments);return o=this,!(n=a)||"object"!==i(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(o):n}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}document.addEventListener("DOMContentLoaded",(function(){!function(t){var e={formlngtag:document.getElementById("lng"),formlattag:document.getElementById("lat"),formzoomtag:document.getElementById("zoom"),formpitchtag:document.getElementById("pitch"),formbearingtag:document.getElementById("bearing"),formsizetag:document.getElementById("size"),formcommenttag:document.getElementById("comment"),maptag:document.getElementById("fmap"),mapwrappertag:document.getElementById("fmapwrapper"),geocodertag:document.getElementById("geocoder"),accesstoken_styleurltag:document.getElementById("accesstoken_styleurl"),lng:document.getElementById("fmap").dataset.lng,lat:document.getElementById("fmap").dataset.lat,zoom:document.getElementById("fmap").dataset.zoom,pitch:document.getElementById("fmap").dataset.pitch,bearing:document.getElementById("fmap").dataset.bearing,styleurl:document.getElementById("accesstoken_styleurl").dataset.styleurl,accesstoken:document.getElementById("accesstoken_styleurl").dataset.accesstoken,comment:document.getElementById("fmap").dataset.comment,mapsize:document.getElementById("fmap").dataset.mapsize,maptype:document.getElementById("fmap").dataset.maptype};if("show"===e.maptype)console.log("field show"),new d(e);else if(0!=e.lng){var a=new h(e);new n(a),console.log("field exsisted")}else if("field"===e.maptype){console.log("field new");var o=new f(e);new n(o)}}()}));var p=function(t){m(a,t);var e=u(a);function a(){return r(this,a),e.apply(this,arguments)}return l(a,[{key:"instantiationMap",value:function(){this.map=new this.mapboxgl.Map({container:"fmap",style:this.styleurl,center:[this.lng,this.lat],zoom:this.zoom,pitch:this.pitch,bearing:this.bearing})}}]),a}(o),h=function(t){m(a,t);var e=u(a);function a(t){var o;return r(this,a),(o=e.call(this,t)).instanceMethod(),o}return l(a,[{key:"instanceMethod",value:function(){this.instantiationMap(),this.instantiationMarker(),this.setMapZoomToForm(this.map),this.addExtentionToMap(this.map),this.getMarkerDropLocation(this.map),this.adaptFormLocationToMarker(),this.setMapPitchToForm(this.map),this.setMapBearingToForm(this.map)}}]),a}(p),f=function(t){m(a,t);var e=u(a);function a(t){var o;return r(this,a),(o=e.call(this,t)).lng=135,o.lat=35,o.zoom=5,o.pitch=0,o.bearing=0,o.instanceMethod(),o}return l(a,[{key:"instanceMethod",value:function(){this.setDefaultValueToForm(),this.instantiationMap(),this.instantiationMarker(),this.setMapZoomToForm(this.map),this.addExtentionToMap(this.map),this.getMarkerDropLocation(this.map),this.adaptFormLocationToMarker(),this.setMapPitchToForm(this.map),this.setMapBearingToForm(this.map)}}]),a}(p),d=function(t){m(a,t);var e=u(a);function a(t){var o;return r(this,a),(o=e.call(this,t)).instanceMethod(),o}return l(a,[{key:"instanceMethod",value:function(){this.instantiationMap(),this.instantiationMarker()}},{key:"instantiationMarker",value:function(){this.marker=new this.mapboxgl.Marker({}).setLngLat(this.map.getCenter()).addTo(this.map)}}]),a}(p);console.log("mapboxfield.js loaded")}();